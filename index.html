<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>您收到了一份早安祝福</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        body { font-family: -apple-system, sans-serif; background: #f0f2f5; margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; justify-content: center; }
        .container { background: white; padding: 20px; border-radius: 30px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 90%; max-width: 400px; text-align: center; }
        .image-box { width: 100%; border-radius: 20px; overflow: hidden; margin-bottom: 20px; background: #eee; aspect-ratio: 1/1; }
        img { width: 100%; height: 100%; object-fit: cover; display: block; }
        h2 { color: #333; margin: 0 0 10px 0; font-size: 1.2rem; }
        .btn-group { display: flex; flex-direction: column; gap: 10px; }
        .btn { padding: 15px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; font-size: 16px; text-decoration: none; }
        .btn-main { background: linear-gradient(90deg, #62be36, #3672d9); color: white; }
        .btn-sub { background: #f8f9fa; color: #666; border: 1px solid #ddd; }
    </style>
</head>
<body>

<div class="container">
    <h2 id="title">好友送來了祝福</h2>
    <div class="image-box">
        <img id="resultImg" src="" alt="早安圖加載中...">
    </div>
    <div class="btn-group">
        <a id="makeBtn" href="#" class="btn btn-main">我也要製作早安圖</a>
        <button onclick="liff.closeWindow()" class="btn btn-sub">關閉視窗</button>
    </div>
</div>

<script>
    const CLOUD_NAME = "dwdkxs8ot";
    const LIFF_ID = "2008941488-Phn5v50S"; // 確保與工具端一致

    async function init() {
        try {
            await liff.init({ liffId: LIFF_ID });
            
            const params = new URLSearchParams(window.location.search);
            const imgId = params.get('id');
            
            if (imgId) {
                // 自動補完網址前綴，實現短連結功能
                const finalUrl = `https://res.cloudinary.com/${CLOUD_NAME}/image/upload/${imgId}.jpg`;
                document.getElementById('resultImg').src = finalUrl;
            } else {
                document.getElementById('title').innerText = "找不到圖片";
            }

            // 設定「我也要製作」的按鈕連結回到您的工具頁面
            // 如果工具頁面就在同一個 LIFF 下，可以直接指回首頁
            document.getElementById('makeBtn').href = `https://liff.line.me/${LIFF_ID}`;
            
        } catch (err) {
            console.error("LIFF 初始化失敗", err);
        }
    }

    init();
</script>
</body>
</html>
